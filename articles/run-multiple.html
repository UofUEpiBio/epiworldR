<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Run Multiple • epiworldR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run Multiple">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epiworldR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.6-0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting started with epiworldR</a></li>
    <li><a class="dropdown-item" href="../articles/implementation.html">Implementation details of epiworldR</a></li>
    <li><a class="dropdown-item" href="../articles/likelihood-free-mcmc.html">Likelihood Free Markhov Chain Monte Carlo (LFMCMC)</a></li>
    <li><a class="dropdown-item" href="../articles/mixing.html">Mixing models</a></li>
    <li><a class="dropdown-item" href="../articles/run-multiple.html">Run Multiple</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UofUEpiBio/epiworldR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run Multiple</h1>
                        <h4 data-toc-skip class="author">Derek
Meyer</h4>
                        <h4 data-toc-skip class="author">George Vega
Yon</h4>
            
            <h4 data-toc-skip class="date">2024-12-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/UofUEpiBio/epiworldR/blob/main/vignettes/run-multiple.Rmd" class="external-link"><code>vignettes/run-multiple.Rmd</code></a></small>
      <div class="d-none name"><code>run-multiple.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The purpose of the “run_multiple” function is to run a specified
number of simulations using the same model object. That is, this
function makes it possible to compare model results across several
separate and repeated simulations.</p>
</div>
<div class="section level2">
<h2 id="example-simulating-a-seirconn-model-50-times">Example: Simulating a SEIRCONN Model 50 Times<a class="anchor" aria-label="anchor" href="#example-simulating-a-seirconn-model-50-times"></a>
</h2>
<div class="section level3">
<h3 id="setup-and-running-model">Setup and Running Model<a class="anchor" aria-label="anchor" href="#setup-and-running-model"></a>
</h3>
<p>To use the “run_multiple” function in epiworld, create your epimodel
of choice; in this case, the example uses a SEIRCONN model for COVID-19,
100000 people, an initial prevalence of 0.0001 (0.01%), a contact rate
of 2, probability of transmission 0.5, a total of 7 incubation days, and
probability of recovery
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mn>3</mn></mfrac><annotation encoding="application/x-tex">\frac{1}{3}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UofUEpiBio/epiworldR" class="external-link">epiworldR</a></span><span class="op">)</span></span>
<span><span class="va">model_seirconn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelSEIRCONN.html">ModelSEIRCONN</a></span><span class="op">(</span></span>
<span>  name              <span class="op">=</span> <span class="st">"COVID-19"</span>,</span>
<span>  n                 <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  prevalence        <span class="op">=</span> <span class="fl">0.0001</span>,</span>
<span>  contact_rate      <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  incubation_days   <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  recovery_rate     <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generating-a-saver">Generating a Saver<a class="anchor" aria-label="anchor" href="#generating-a-saver"></a>
</h3>
<p>Next, generate a saver for the purpose of extracting the “total_hist”
and “reproductive” information from the model object. Now, use the
“run_multiple” function with the model object, number of desired days to
run the simulation, number of simulations to run, and number of threads
for parallel computing.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generating a saver</span></span>
<span><span class="va">saver</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_multiple.html">make_saver</a></span><span class="op">(</span><span class="st">"total_hist"</span>, <span class="st">"reproductive"</span><span class="op">)</span></span>
<span><span class="co"># Running and printing</span></span>
<span><span class="fu"><a href="../reference/run_multiple.html">run_multiple</a></span><span class="op">(</span><span class="va">model_seirconn</span>, ndays <span class="op">=</span> <span class="fl">50</span>, nsims <span class="op">=</span> <span class="fl">50</span>, saver <span class="op">=</span> <span class="va">saver</span>, nthreads <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting multiple runs (50) using 2 thread(s)</span></span>
<span><span class="co">#&gt; _________________________________________________________________________</span></span>
<span><span class="co">#&gt; _________________________________________________________________________</span></span>
<span><span class="co">#&gt; ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.</span></span>
<span><span class="co">#&gt;  done.</span></span></code></pre></div>
<p>Using the “run_multiple_get_results” function, extract the results
from the model object that was simulated 50 times for comparison across
simulations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieving the results</span></span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_multiple.html">run_multiple_get_results</a></span><span class="op">(</span><span class="va">model_seirconn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ans</span><span class="op">$</span><span class="va">total_hist</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sim_num date nviruses       state counts</span></span>
<span><span class="co">#&gt; 1       1    0        1 Susceptible   9999</span></span>
<span><span class="co">#&gt; 2       1    0        1     Exposed      1</span></span>
<span><span class="co">#&gt; 3       1    0        1    Infected      0</span></span>
<span><span class="co">#&gt; 4       1    0        1   Recovered      0</span></span>
<span><span class="co">#&gt; 5       1    1        1 Susceptible   9999</span></span>
<span><span class="co">#&gt; 6       1    1        1     Exposed      1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ans</span><span class="op">$</span><span class="va">reproductive</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sim_num virus_id    virus source source_exposure_date rt</span></span>
<span><span class="co">#&gt; 1       2        0 COVID-19   9964                   50  0</span></span>
<span><span class="co">#&gt; 2       2        0 COVID-19   9828                   50  0</span></span>
<span><span class="co">#&gt; 3       2        0 COVID-19   9689                   50  0</span></span>
<span><span class="co">#&gt; 4       2        0 COVID-19   9687                   50  0</span></span>
<span><span class="co">#&gt; 5       2        0 COVID-19   9651                   50  0</span></span>
<span><span class="co">#&gt; 6       2        0 COVID-19   9277                   50  0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h3>
<p>To plot the epicurves and reproductive numbers over time using
boxplots, extract the results from the model object using
“run_multiple_get_results”. For this example, the dates are filtered to
be less than or equal to 20 to observe the epicurves in the first 20
days. Notice each boxplot in the below table represents the observed
values from each of the 50 simulations for each date.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seirconn_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_multiple.html">run_multiple_get_results</a></span><span class="op">(</span><span class="va">model_seirconn</span><span class="op">)</span><span class="op">$</span><span class="va">total_hist</span></span>
<span><span class="va">seirconn_50</span> <span class="op">&lt;-</span> <span class="va">seirconn_50</span><span class="op">[</span><span class="va">seirconn_50</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;=</span> <span class="fl">20</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">seirconn_50</span><span class="op">)</span></span></code></pre></div>
<p><img src="run-multiple_files/figure-html/plotting%20seirconn%20epicurves-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>To view the a plot of the reproductive number over all 50 days for
each of the 50 simulations, store the reproductive results to a new
object using “run_multiple_get_results”, then plot using the “boxplot”
function. Notice each source exposure date displays a boxplot
representing the distribution of reproductive numbers across all 50
simulations. As expected, the reproductive number on average, decreases
over time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seirconn_50_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_multiple.html">run_multiple_get_results</a></span><span class="op">(</span><span class="va">model_seirconn</span><span class="op">)</span><span class="op">$</span><span class="va">reproductive</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">seirconn_50_r</span><span class="op">)</span></span></code></pre></div>
<p><img src="run-multiple_files/figure-html/reproductive%20number%20plot-1.png" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># boxplot(rt ~ source_exposure_date, data = seirconn_50_r,</span></span>
<span><span class="co">#         main = "Reproductive Number",</span></span>
<span><span class="co">#         xlab = "Source Exposure Date",</span></span>
<span><span class="co">#         ylab = "rt",</span></span>
<span><span class="co">#         border = "black",</span></span>
<span><span class="co">#         las = 2)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by George Vega Yon, Derek Meyer, Andrew Pulsipher, Centers for Disease Control and Prevention.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
