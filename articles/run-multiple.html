<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="epiworldR">
<title>Run Multiple • epiworldR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run Multiple">
<meta property="og:description" content="epiworldR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">epiworldR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0-1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting-started.html">Getting started with epiworldR</a>
    <a class="dropdown-item" href="../articles/run-multiple.html">Run Multiple</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/UofUEpiBio/epiworldR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Run Multiple</h1>
                        <h4 data-toc-skip class="author">Derek
Meyer</h4>
                        <h4 data-toc-skip class="author">George Vega
Yon</h4>
            
            <h4 data-toc-skip class="date">2023-05-31</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/UofUEpiBio/epiworldR/blob/HEAD/vignettes/run-multiple.Rmd" class="external-link"><code>vignettes/run-multiple.Rmd</code></a></small>
      <div class="d-none name"><code>run-multiple.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The purpose of the “run_multiple” function is to run a specified
number of simulations using the same model object. That is, this
function makes it possible to compare model results across several
separate and repeated simulations.</p>
</div>
<div class="section level2">
<h2 id="example-simulating-a-seirconn-model-50-times">Example: Simulating a SEIRCONN Model 50 Times<a class="anchor" aria-label="anchor" href="#example-simulating-a-seirconn-model-50-times"></a>
</h2>
<div class="section level3">
<h3 id="setup-and-running-model">Setup and Running Model<a class="anchor" aria-label="anchor" href="#setup-and-running-model"></a>
</h3>
<p>To use the “run_multiple” function in epiworld, create your epimodel
of choice; in this case, the example uses a SEIRCONN model for COVID-19,
100000 people, an initial prevalence of 0.0001 (0.01%), a contact rate
of 2, probability of transmission 0.5, a total of 7 incubation days, and
probability of recovery <span class="math inline">\(\frac{1}{3}\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UofUEpiBio/epiworldR" class="external-link">epiworldR</a></span><span class="op">)</span></span>
<span><span class="va">model_seirconn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelSEIRCONN.html">ModelSEIRCONN</a></span><span class="op">(</span></span>
<span>  name              <span class="op">=</span> <span class="st">"COVID-19"</span>,</span>
<span>  n                 <span class="op">=</span> <span class="fl">10000</span>, </span>
<span>  prevalence        <span class="op">=</span> <span class="fl">0.0001</span>, </span>
<span>  contact_rate      <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  prob_transmission <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  incubation_days   <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  prob_recovery     <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generating-a-saver">Generating a Saver<a class="anchor" aria-label="anchor" href="#generating-a-saver"></a>
</h3>
<p>Next, generate a saver for the purpose of extracting the “total_hist”
and “reproductive” information from the model object. Now, use the
“run_multiple” function with the model object, number of desired days to
run the simulation, number of simulations to run, and number of threads
for parallel computing.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generating a saver</span></span>
<span><span class="va">saver</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_multiple.html">make_saver</a></span><span class="op">(</span><span class="st">"total_hist"</span>, <span class="st">"reproductive"</span><span class="op">)</span></span>
<span><span class="co"># Running and printing</span></span>
<span><span class="fu"><a href="../reference/run_multiple.html">run_multiple</a></span><span class="op">(</span><span class="va">model_seirconn</span>, ndays <span class="op">=</span> <span class="fl">50</span>, nsims <span class="op">=</span> <span class="fl">50</span>, saver <span class="op">=</span> <span class="va">saver</span>, nthread <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting multiple runs (50) using 2 thread(s)</span></span>
<span><span class="co">#&gt; _________________________________________________________________________</span></span>
<span><span class="co">#&gt; _________________________________________________________________________</span></span>
<span><span class="co">#&gt; ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||| done.</span></span>
<span><span class="co">#&gt;  done.</span></span></code></pre></div>
<p>Using the “run_multiple_get_results” function, extract the results
from the model object that was simulated 50 times for comparison across
simulations.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Retrieving the results</span></span>
<span><span class="va">ans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_multiple.html">run_multiple_get_results</a></span><span class="op">(</span><span class="va">model_seirconn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ans</span><span class="op">$</span><span class="va">total_hist</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sim_num thread date nvariants       state counts</span></span>
<span><span class="co">#&gt; 1       1      0    0         1 Susceptible   9999</span></span>
<span><span class="co">#&gt; 2       1      0    0         1     Exposed      1</span></span>
<span><span class="co">#&gt; 3       1      0    0         1    Infected      0</span></span>
<span><span class="co">#&gt; 4       1      0    0         1   Recovered      0</span></span>
<span><span class="co">#&gt; 5       1      0    1         1 Susceptible   9999</span></span>
<span><span class="co">#&gt; 6       1      0    1         1     Exposed      0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ans</span><span class="op">$</span><span class="va">reproductive</span><span class="op">)</span></span>
<span><span class="co">#&gt;   sim_num thread variant source source_exposure_date rt</span></span>
<span><span class="co">#&gt; 1       1      0       0     55                   50  0</span></span>
<span><span class="co">#&gt; 2       1      0       0    103                   50  0</span></span>
<span><span class="co">#&gt; 3       1      0       0    145                   50  0</span></span>
<span><span class="co">#&gt; 4       1      0       0    161                   50  0</span></span>
<span><span class="co">#&gt; 5       1      0       0    263                   50  0</span></span>
<span><span class="co">#&gt; 6       1      0       0    301                   50  0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h3>
<p>To plot the epicurves and reproductive numbers over time using
boxplots, extract the results from the model object using
“run_multiple_get_results”. For this example, the dates are filtered to
be less than or equal to 20 to observe the epicurves in the first 20
days. Notice each boxplot in the below table represents the observed
values from each of the 50 simulations for each date.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seirconn_50</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_multiple.html">run_multiple_get_results</a></span><span class="op">(</span><span class="va">model_seirconn</span><span class="op">)</span><span class="op">$</span><span class="va">total_hist</span></span>
<span><span class="va">seirconn_50</span> <span class="op">&lt;-</span> <span class="va">seirconn_50</span><span class="op">[</span><span class="va">seirconn_50</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;=</span> <span class="fl">20</span>,<span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">seirconn_50</span><span class="op">)</span></span></code></pre></div>
<p><img src="run-multiple_files/figure-html/plotting%20seirconn%20epicurves-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>To view the a plot of the reproductive number over all 50 days for
each of the 50 simulations, store the reproductive results to a new
object using “run_multiple_get_results”, then plot using the “boxplot”
function. Notice each source exposure date displays a boxplot
representing the distribution of reproductive numbers across all 50
simulations. As expected, the reproductive number on average, decreases
over time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">seirconn_50_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_multiple.html">run_multiple_get_results</a></span><span class="op">(</span><span class="va">model_seirconn</span><span class="op">)</span><span class="op">$</span><span class="va">reproductive</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">seirconn_50_r</span><span class="op">)</span></span></code></pre></div>
<p><img src="run-multiple_files/figure-html/reproductive%20number%20plot-1.png" width="80%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># boxplot(rt ~ source_exposure_date, data = seirconn_50_r,</span></span>
<span><span class="co">#         main = "Reproductive Number",</span></span>
<span><span class="co">#         xlab = "Source Exposure Date",</span></span>
<span><span class="co">#         ylab = "rt",</span></span>
<span><span class="co">#         border = "black",</span></span>
<span><span class="co">#         las = 2)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Derek Meyer, George Vega Yon, Centers for Disease Control and Prevention.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
