<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Likelihood Free Markhov Chain Monte Carlo (LFMCMC) • epiworldR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Likelihood Free Markhov Chain Monte Carlo (LFMCMC)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epiworldR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced-modeling.html">Advanced Modeling - Multiple Diseases, Tools, and Events</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting started with epiworldR</a></li>
    <li><a class="dropdown-item" href="../articles/implementation.html">Implementation details of epiworldR</a></li>
    <li><a class="dropdown-item" href="../articles/likelihood-free-mcmc.html">Likelihood Free Markhov Chain Monte Carlo (LFMCMC)</a></li>
    <li><a class="dropdown-item" href="../articles/mixing.html">Mixing models</a></li>
    <li><a class="dropdown-item" href="../articles/run-multiple.html">Run Multiple</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UofUEpiBio/epiworldR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Likelihood Free Markhov Chain Monte Carlo (LFMCMC)</h1>
                        <h4 data-toc-skip class="author">Andrew
Pulsipher</h4>
            
            <h4 data-toc-skip class="date">2025-05-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/UofUEpiBio/epiworldR/blob/main/vignettes/likelihood-free-mcmc.Rmd" class="external-link"><code>vignettes/likelihood-free-mcmc.Rmd</code></a></small>
      <div class="d-none name"><code>likelihood-free-mcmc.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The purpose of the “LFMCMC” class in epiworldR is to perform a
Likelihood-Free Markhov Chain Monte Carlo (LFMCMC) simulation. LFMCMC is
used to approximate models where the likelihood function is either
unavailable or computationally expensive. This example assumes a general
understanding of LFMCMC. To learn more about it, see the Handbook of
Markhov Chain Monte Carlo by Brooks et al. <a href="https://doi.org/10.1201/b10905" class="external-link uri">https://doi.org/10.1201/b10905</a>.</p>
<p>In this example, we use LFMCMC to recover the parameters of an SIR
model.</p>
</div>
<div class="section level2">
<h2 id="setup-the-sir-model">Setup The SIR Model<a class="anchor" aria-label="anchor" href="#setup-the-sir-model"></a>
</h2>
<p>Our SIR model will have the following characteristics:</p>
<ul>
<li>
<strong>Virus Name:</strong> COVID-19</li>
<li>
<strong>Initial Virus Prevalence:</strong> 0.01</li>
<li>
<strong>Recovery Rate:</strong> 1/7 (0.14)</li>
<li>
<strong>Transmission Rate:</strong> 0.1</li>
<li>
<strong>Number of Agents:</strong> 2,000</li>
</ul>
<p>We use the <code>ModelSIR</code> and <code>agents_smallworld</code>
functions to construct the model in epiworldR.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UofUEpiBio/epiworldR" class="external-link">epiworldR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_seed</span> <span class="op">&lt;-</span> <span class="fl">122</span></span>
<span></span>
<span><span class="va">model_sir</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelSIR.html">ModelSIR</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"COVID-19"</span>,</span>
<span>  prevalence <span class="op">=</span> <span class="fl">.01</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>  recovery_rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">7</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/agents_smallworld.html">agents_smallworld</a></span><span class="op">(</span></span>
<span>  <span class="va">model_sir</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  d <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Then we run the model for 50 days and print the results.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/epiworld-methods.html">verbose_off</a></span><span class="op">(</span><span class="va">model_sir</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/epiworld-methods.html">run</a></span><span class="op">(</span></span>
<span>  <span class="va">model_sir</span>,</span>
<span>  ndays <span class="op">=</span> <span class="fl">50</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">model_seed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_sir</span><span class="op">)</span></span>
<span><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span><span class="co">#&gt; SIMULATION STUDY</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Name of the model   : Susceptible-Infected-Recovered (SIR)</span></span>
<span><span class="co">#&gt; Population size     : 2000</span></span>
<span><span class="co">#&gt; Agents' data        : (none)</span></span>
<span><span class="co">#&gt; Number of entities  : 0</span></span>
<span><span class="co">#&gt; Days (duration)     : 50 (of 50)</span></span>
<span><span class="co">#&gt; Number of viruses   : 1</span></span>
<span><span class="co">#&gt; Last run elapsed t  : 350.00µs</span></span>
<span><span class="co">#&gt; Last run speed      : 285.71 million agents x day / second</span></span>
<span><span class="co">#&gt; Rewiring            : off</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global events:</span></span>
<span><span class="co">#&gt;  (none)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Virus(es):</span></span>
<span><span class="co">#&gt;  - COVID-19</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tool(s):</span></span>
<span><span class="co">#&gt;  (none)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model parameters:</span></span>
<span><span class="co">#&gt;  - Recovery rate     : 0.1429</span></span>
<span><span class="co">#&gt;  - Transmission rate : 0.1000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Distribution of the population at time 50:</span></span>
<span><span class="co">#&gt;   - (0) Susceptible : 1980 -&gt; 1865</span></span>
<span><span class="co">#&gt;   - (1) Infected    :   20 -&gt; 0</span></span>
<span><span class="co">#&gt;   - (2) Recovered   :    0 -&gt; 135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transition Probabilities:</span></span>
<span><span class="co">#&gt;  - Susceptible  1.00  0.00     -</span></span>
<span><span class="co">#&gt;  - Infected        -  0.85  0.15</span></span>
<span><span class="co">#&gt;  - Recovered       -     -  1.00</span></span></code></pre></div>
<p>Note the “Model parameters” and the “Distribution of the population
at time 50” from the above output. Our goal is to recover the model
parameters (Recovery and Transmission rates) through LFMCMC. We
accomplish this by comparing the population distribution from each
simulation run to the “observed” distribution from our model. We get
this distribution using the <code>get_today_total</code> function in
epiworldR.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_sir_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epiworld-data.html">get_today_total</a></span><span class="op">(</span><span class="va">model_sir</span><span class="op">)</span></span></code></pre></div>
<p>For practical cases, you would use observed data, instead of a model
simulation. We use a simulation in our example to show the accuracy of
LFMCMC in recovering the model parameters. Whenever we use the term
“observed data” below, we are referring to the model distribution
(<code>model_sir_data</code>).</p>
</div>
<div class="section level2">
<h2 id="setup-lfmcmc">Setup LFMCMC<a class="anchor" aria-label="anchor" href="#setup-lfmcmc"></a>
</h2>
<p>In epiworldR, LFMCMC requires four functions:</p>
<p>The <strong>simulation function</strong> runs a model with a given
set of parameters and produces output that matches the structure of our
observed data. For our example, we set the Recovery and Transmission
rate parameters, run an SIR model for 50 days, and return the
distribution of the population at the end of the run.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simulation_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">params</span>, <span class="va">lfmcmc_obj</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/epiworld-methods.html">set_param</a></span><span class="op">(</span><span class="va">model_sir</span>, <span class="st">"Recovery rate"</span>, <span class="va">params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/epiworld-methods.html">set_param</a></span><span class="op">(</span><span class="va">model_sir</span>, <span class="st">"Transmission rate"</span>, <span class="va">params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/epiworld-methods.html">run</a></span><span class="op">(</span></span>
<span>    <span class="va">model_sir</span>,</span>
<span>    ndays <span class="op">=</span> <span class="fl">50</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/epiworld-data.html">get_today_total</a></span><span class="op">(</span><span class="va">model_sir</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <strong>summary function</strong> extracts summary statistics
from the given data. This should produce the same output format for both
the observed data and the simulated data from
<code>simulation_fun</code>. For our example, since the population
distribution is already a summary of the data, our summary function
simply passes that data through. With more complicated use cases, you
might instead compute summary statistics such as the mean or standard
deviation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">lfmcmc_obj</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <strong>proposal function</strong> returns a new set of
parameters, which it is “proposing” parameters for the LFMCMC algorithm
to try in the simulation function. In our example, it takes the
parameters from the previous run (<code>old_params</code>) and does a
random step away from those values.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proposal_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">old_params</span>, <span class="va">lfmcmc_obj</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis</a></span><span class="op">(</span><span class="va">old_params</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">old_params</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>The <strong>kernel function</strong> effectively scores the results
of the latest simulation run against the observed data, by comparing the
summary statistics from <code>summary_fun</code> for each. LFMCMC uses
the kernel score and the Hastings Ratio to determine whether or not to
accept the parameters for that run. In our example, since
<code>summary_fun</code> simply passes the data through,
<code>simulated_stats</code> and <code>observed_stats</code> are our
simulated and observed data respectively.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kernel_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>    <span class="va">simulated_stats</span>, <span class="va">observed_stats</span>, <span class="va">epsilon</span>, <span class="va">lfmcmc_obj</span></span>
<span>    <span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>  <span class="va">diff</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">simulated_stats</span> <span class="op">-</span> <span class="va">observed_stats</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="va">epsilon</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">diff</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>With all four functions defined, we can initialize the simulation
object using the <code>LFMCMC</code> function in epiworldR along with
the appropriate setter functions.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lfmcmc_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LFMCMC.html">LFMCMC</a></span><span class="op">(</span><span class="va">model_sir</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/LFMCMC.html">set_simulation_fun</a></span><span class="op">(</span><span class="va">simulation_fun</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/LFMCMC.html">set_summary_fun</a></span><span class="op">(</span><span class="va">summary_fun</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/LFMCMC.html">set_proposal_fun</a></span><span class="op">(</span><span class="va">proposal_fun</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/LFMCMC.html">set_kernel_fun</a></span><span class="op">(</span><span class="va">kernel_fun</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/LFMCMC.html">set_observed_data</a></span><span class="op">(</span><span class="va">model_sir_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="run-lfmcmc-simulation">Run LFMCMC Simulation<a class="anchor" aria-label="anchor" href="#run-lfmcmc-simulation"></a>
</h2>
<p>To run LFMCMC, we need to set the initial model parameters. For our
example, we use an initial Recovery rate of 0.3 and an initial
Transmission rate of 0.3. We set the kernel epsilon to 1.0 and run the
simulation for 2,000 samples (iterations) using the
<code>run_lfmcmc</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">initial_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span>
<span></span>
<span><span class="co"># Run the LFMCMC simulation</span></span>
<span><span class="fu"><a href="../reference/LFMCMC.html">run_lfmcmc</a></span><span class="op">(</span></span>
<span>  lfmcmc <span class="op">=</span> <span class="va">lfmcmc_model</span>,</span>
<span>  params_init <span class="op">=</span> <span class="va">initial_params</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="va">n_samples</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="va">epsilon</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">model_seed</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; _________________________________________________________________________</span></span>
<span><span class="co">#&gt; |||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>To make the printed results easier to read, we use the
<code>set_params_names</code> and <code>set_stats_names</code> functions
before calling <code>print</code>. We also use a burn-in period of 1,500
samples.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/LFMCMC.html">set_params_names</a></span><span class="op">(</span><span class="va">lfmcmc_model</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Recovery rate"</span>, <span class="st">"Transmission rate"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/LFMCMC.html">set_stats_names</a></span><span class="op">(</span><span class="va">lfmcmc_model</span>, <span class="fu"><a href="../reference/epiworld-methods.html">get_states</a></span><span class="op">(</span><span class="va">model_sir</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lfmcmc_model</span>, burnin <span class="op">=</span> <span class="fl">1500</span><span class="op">)</span></span>
<span><span class="co">#&gt; ___________________________________________</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LIKELIHOOD-FREE MARKOV CHAIN MONTE CARLO</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; N Samples (total) : 2000</span></span>
<span><span class="co">#&gt; N Samples (after burn-in period) : 500</span></span>
<span><span class="co">#&gt; Elapsed t : 1.00s</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameters:</span></span>
<span><span class="co">#&gt;   -Recovery rate     :  0.14 [ 0.13,  0.15] (initial :  0.30)</span></span>
<span><span class="co">#&gt;   -Transmission rate :  0.09 [ 0.09,  0.10] (initial :  0.30)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Statistics:</span></span>
<span><span class="co">#&gt;   -Susceptible :  1865.49 [ 1864.00,  1866.00] (Observed:  1865.00)</span></span>
<span><span class="co">#&gt;   -Infected    :     0.00 [    0.00,     0.00] (Observed:     0.00)</span></span>
<span><span class="co">#&gt;   -Recovered   :   134.51 [  134.00,   136.00] (Observed:   135.00)</span></span>
<span><span class="co">#&gt; ___________________________________________</span></span></code></pre></div>
<p>We can also look at the trace of the parameters:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extracting the accepted parameters</span></span>
<span><span class="va">accepted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/LFMCMC.html">get_all_accepted_params</a></span><span class="op">(</span><span class="va">lfmcmc_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plotting the trace</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">accepted</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Trace of the parameters"</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"tomato"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Step"</span>,</span>
<span>  ylab <span class="op">=</span> <span class="st">"Parameter value"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">accepted</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"topright"</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span>,</span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Recovery rate"</span>, <span class="st">"Transmission rate"</span><span class="op">)</span>,</span>
<span>  pch    <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  col    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tomato"</span>, <span class="st">"steelblue"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="likelihood-free-mcmc_files/figure-html/post-dist-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Recall that the observed data came from a model with a Recovery rate
of 0.3 and a Transmission rate of 0.3. As the above output shows, LFMCMC
made a close approximation of the parameters, which resulted in a close
approximation of the observed population distribution. This example
highlights the effectiveness of using LFMCMC for highly complex
models.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by George Vega Yon, Derek Meyer, Andrew Pulsipher, Centers for Disease Control and Prevention.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
