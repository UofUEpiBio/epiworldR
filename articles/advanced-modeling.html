<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced Modeling - Multiple Diseases, Tools, and Events • epiworldR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Advanced Modeling - Multiple Diseases, Tools, and Events">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epiworldR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced-modeling.html">Advanced Modeling - Multiple Diseases, Tools, and Events</a></li>
    <li><a class="dropdown-item" href="../articles/getting-started.html">Getting started with epiworldR</a></li>
    <li><a class="dropdown-item" href="../articles/implementation.html">Implementation details of epiworldR</a></li>
    <li><a class="dropdown-item" href="../articles/likelihood-free-mcmc.html">Likelihood Free Markhov Chain Monte Carlo (LFMCMC)</a></li>
    <li><a class="dropdown-item" href="../articles/mixing.html">Mixing models</a></li>
    <li><a class="dropdown-item" href="../articles/run-multiple.html">Run Multiple</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UofUEpiBio/epiworldR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Advanced Modeling - Multiple Diseases, Tools, and Events</h1>
                        <h4 data-toc-skip class="author">Andrew
Pulsipher</h4>
            
            <h4 data-toc-skip class="date">2025-07-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/UofUEpiBio/epiworldR/blob/main/vignettes/advanced-modeling.Rmd" class="external-link"><code>vignettes/advanced-modeling.Rmd</code></a></small>
      <div class="d-none name"><code>advanced-modeling.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>epiworldR</code> models can have multiple viruses, tools, and
events. This vignette walks through an example of an advanced model with
multiple interacting pieces.</p>
<div class="section level3">
<h3 id="example-scenario-simultaneous-covid-19-and-flu-outbreaks">Example Scenario: Simultaneous COVID-19 and Flu Outbreaks<a class="anchor" aria-label="anchor" href="#example-scenario-simultaneous-covid-19-and-flu-outbreaks"></a>
</h3>
<p>The example implements the following scenario:</p>
<ul>
<li>
<strong>Diseases:</strong> COVID-19 and Flu</li>
<li>
<strong>Population size:</strong> 50,000 agents</li>
<li>
<strong>Contact Rate:</strong> 4</li>
<li>
<strong>Recovery Rate:</strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mn>4</mn></mfrac><annotation encoding="application/x-tex">\frac{1}{4}</annotation></semantics></math>
(same for both diseases)</li>
<li>
<em>COVID-19 Parameters</em>
<ul>
<li>
<strong>Initial Prevalence:</strong> 0.001</li>
<li>
<strong>Transmission Rate:</strong> 0.5</li>
</ul>
</li>
<li>
<em>Flu Parameters</em>
<ul>
<li>
<strong>Initial Prevalence:</strong> 0.001</li>
<li>
<strong>Transmission Rate:</strong> 0.35</li>
</ul>
</li>
</ul>
<p>We’ll go through the process step-by-step. After each step, we’ll run
the model for 50 days and plot it to illustrate how each added component
changes the base model.</p>
<div class="section level4">
<h4 id="model-setup">Model Setup<a class="anchor" aria-label="anchor" href="#model-setup"></a>
</h4>
<p>We start with a <code>ModelSIRCONN</code> model for COVID-19. We’ll
add the flu virus and our tools and events to this base model.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UofUEpiBio/epiworldR" class="external-link">epiworldR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Thank you for using epiworldR! Please consider citing it in your work.</span></span>
<span><span class="co">#&gt; You can find the citation information by running</span></span>
<span><span class="co">#&gt;   citation("epiworldR")</span></span>
<span></span>
<span><span class="va">model_sirconn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ModelSIRCONN.html">ModelSIRCONN</a></span><span class="op">(</span></span>
<span>  name              <span class="op">=</span> <span class="st">"COVID-19"</span>,</span>
<span>  n                 <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  contact_rate      <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  recovery_rate     <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">4</span>,</span>
<span>  prevalence        <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  transmission_rate <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/epiworld-methods.html">verbose_off</a></span><span class="op">(</span><span class="va">model_sirconn</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/epiworld-methods.html">run</a></span><span class="op">(</span><span class="va">model_sirconn</span>, ndays <span class="op">=</span> <span class="fl">50</span>, seed <span class="op">=</span> <span class="fl">1912</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_sirconn</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced-modeling_files/figure-html/run-base-model-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="add-the-flu-virus">Add the Flu Virus<a class="anchor" aria-label="anchor" href="#add-the-flu-virus"></a>
</h4>
<p>Create the second virus using the <code><a href="../reference/virus.html">virus()</a></code> function. The
parameter <code>prob_infecting</code> is the transmission rate. The
parameter <code>as_proportion</code> tells the function to interpret the
prevalence as a proportion of the population, rather than a fixed
value.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flu_virus</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/virus.html">virus</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Flu"</span>, prob_infecting <span class="op">=</span> <span class="fl">.35</span>, prevalence <span class="op">=</span> <span class="fl">0.001</span>, as_proportion <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Add the virus to the model with the <code><a href="../reference/virus.html">add_virus()</a></code>
function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/virus.html">add_virus</a></span><span class="op">(</span><span class="va">model_sirconn</span>, <span class="va">flu_virus</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/epiworld-methods.html">run</a></span><span class="op">(</span><span class="va">model_sirconn</span>, ndays <span class="op">=</span> <span class="fl">50</span>, seed <span class="op">=</span> <span class="fl">1912</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_sirconn</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced-modeling_files/figure-html/run-model-flu-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="add-a-tool-vaccine">Add a Tool (Vaccine)<a class="anchor" aria-label="anchor" href="#add-a-tool-vaccine"></a>
</h4>
<p>In <code>epiworldR</code>, agents use tools to fight diseases. Create
the vaccine tool using the <code><a href="../reference/tool.html">tool()</a></code> function, with parameters
that indicate how the tool modifies the disease parameters. We set our
vaccine to reduce the susceptibility of agents by 90%, the transmission
rate of infected agents by 50%, and the death rate by 90%. The vaccine
further enhances the recovery rate by 50%.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vaccine_tool</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tool.html">tool</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Vaccine"</span>,</span>
<span>  susceptibility_reduction <span class="op">=</span> <span class="fl">.9</span>,</span>
<span>  transmission_reduction <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  recovery_enhancer <span class="op">=</span> <span class="fl">.5</span>,</span>
<span>  death_reduction <span class="op">=</span> <span class="fl">.9</span>,</span>
<span>  prevalence <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  as_proportion <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Use the <code><a href="../reference/tool.html">set_distribution_tool()</a></code> function to define the
proportion of the population to receive the tool (set here to 50%).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tool.html">set_distribution_tool</a></span><span class="op">(</span></span>
<span>  tool <span class="op">=</span> <span class="va">vaccine_tool</span>,</span>
<span>  distfun <span class="op">=</span> <span class="fu"><a href="../reference/tool.html">distribute_tool_randomly</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Add the vaccine to the model using the <code><a href="../reference/tool.html">add_tool()</a></code>
function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/tool.html">add_tool</a></span><span class="op">(</span><span class="va">model_sirconn</span>, <span class="va">vaccine_tool</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/epiworld-methods.html">run</a></span><span class="op">(</span><span class="va">model_sirconn</span>, ndays <span class="op">=</span> <span class="fl">50</span>, seed <span class="op">=</span> <span class="fl">1912</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_sirconn</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced-modeling_files/figure-html/run-model-vaccine-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Note how the vaccine flattens the Infected curve.</p>
</div>
<div class="section level4">
<h4 id="add-events">Add Events<a class="anchor" aria-label="anchor" href="#add-events"></a>
</h4>
<p>In <code>epiworldR</code>, all models automatically have a global
event that runs each day to update the agents. For this example, we’ll
add two additional events that represent public health interventions
that start partway through the simulation as the dual-disease outbreak
begins to gain traction:</p>
<ul>
<li>Beginning on Day 10, a policy of social isolation is adopted which
reduces the contact rate to 2</li>
<li>Beginning on Day 20, a TV advertisement is run increasing awareness
of the outbreak, reducing the contact rate further to 1.5</li>
</ul>
<p>Create these events using the <code><a href="../reference/global-events.html">globalevent_set_params()</a></code>
function, specifying the day to run the event.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">isolation_day_10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/global-events.html">globalevent_set_params</a></span><span class="op">(</span><span class="st">"Contact rate"</span>, <span class="fl">2</span>, day <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">advertisement_day_20</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/global-events.html">globalevent_set_params</a></span><span class="op">(</span><span class="st">"Contact rate"</span>, <span class="fl">1.5</span>, day <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p>Add the events to the model with the <code><a href="../reference/global-events.html">add_globalevent()</a></code>
function.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/global-events.html">add_globalevent</a></span><span class="op">(</span><span class="va">model_sirconn</span>, <span class="va">isolation_day_10</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/global-events.html">add_globalevent</a></span><span class="op">(</span><span class="va">model_sirconn</span>, <span class="va">advertisement_day_20</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/epiworld-methods.html">run</a></span><span class="op">(</span><span class="va">model_sirconn</span>, ndays <span class="op">=</span> <span class="fl">50</span>, seed <span class="op">=</span> <span class="fl">1912</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_sirconn</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced-modeling_files/figure-html/run-full-model-1.png" width="80%" style="display: block; margin: auto;"></p>
<p>Note the sharp change to the infected curve corresponding to
adoptiong of the social isolation policy.</p>
</div>
<div class="section level4">
<h4 id="full-model-summary">Full Model Summary<a class="anchor" aria-label="anchor" href="#full-model-summary"></a>
</h4>
<p>With our advanced model complete, we can view the summary, noting the
events, viruses, and tools we added to the model.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_sirconn</span><span class="op">)</span></span>
<span><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span><span class="co">#&gt; ________________________________________________________________________________</span></span>
<span><span class="co">#&gt; SIMULATION STUDY</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Name of the model   : Susceptible-Infected-Removed (SIR) (connected)</span></span>
<span><span class="co">#&gt; Population size     : 50000</span></span>
<span><span class="co">#&gt; Agents' data        : (none)</span></span>
<span><span class="co">#&gt; Number of entities  : 0</span></span>
<span><span class="co">#&gt; Days (duration)     : 50 (of 50)</span></span>
<span><span class="co">#&gt; Number of viruses   : 2</span></span>
<span><span class="co">#&gt; Last run elapsed t  : 104.00ms</span></span>
<span><span class="co">#&gt; Total elapsed t     : 359.00ms (4 runs)</span></span>
<span><span class="co">#&gt; Last run speed      : 23.98 million agents x day / second</span></span>
<span><span class="co">#&gt; Average run speed   : 27.80 million agents x day / second</span></span>
<span><span class="co">#&gt; Rewiring            : off</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global events:</span></span>
<span><span class="co">#&gt;  - Update infected individuals (runs daily)</span></span>
<span><span class="co">#&gt;  - Set Contact rate to 2 (day 10)</span></span>
<span><span class="co">#&gt;  - Set Contact rate to 1.5 (day 20)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Virus(es):</span></span>
<span><span class="co">#&gt;  - COVID-19</span></span>
<span><span class="co">#&gt;  - Flu</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tool(s):</span></span>
<span><span class="co">#&gt;  - Vaccine</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Model parameters:</span></span>
<span><span class="co">#&gt;  - Contact rate      : 1.5000</span></span>
<span><span class="co">#&gt;  - Recovery rate     : 0.2500</span></span>
<span><span class="co">#&gt;  - Transmission rate : 0.5000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Distribution of the population at time 50:</span></span>
<span><span class="co">#&gt;   - (0) Susceptible : 49900 -&gt; 22928</span></span>
<span><span class="co">#&gt;   - (1) Infected    :   100 -&gt; 3</span></span>
<span><span class="co">#&gt;   - (2) Recovered   :     0 -&gt; 27069</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transition Probabilities:</span></span>
<span><span class="co">#&gt;  - Susceptible  0.98  0.02     -</span></span>
<span><span class="co">#&gt;  - Infected        -  0.72  0.28</span></span>
<span><span class="co">#&gt;  - Recovered       -     -  1.00</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="reproductive-numbers">Reproductive Numbers<a class="anchor" aria-label="anchor" href="#reproductive-numbers"></a>
</h4>
<p>The model computes two reproductive numbers, one for each virus.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">repnum2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/epiworld-data.html">get_reproductive_number</a></span><span class="op">(</span><span class="va">model_sirconn</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">repnum2</span>, type <span class="op">=</span> <span class="st">"b"</span><span class="op">)</span></span></code></pre></div>
<p><img src="advanced-modeling_files/figure-html/reproductive-numbers-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by George Vega Yon, Derek Meyer, Andrew Pulsipher, Centers for Disease Control and Prevention.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
